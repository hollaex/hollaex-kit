{"version":3,"sources":["../../../../src/lib/annotation/Label.js"],"names":["React","Component","PropTypes","GenericComponent","isDefined","hexToRGBA","functor","LabelAnnotation","defaultProps","helper","Label","props","renderSVG","bind","drawOnCanvas","ctx","moreProps","drawOnCanvas2","context","selectCanvas","chartConfig","getYScale","getText","text","Array","isArray","undefined","yScale","propTypes","className","string","func","oneOfType","isRequired","textAnchor","fontFamily","fontSize","number","opacity","rotate","onClick","xAccessor","xScale","datum","object","x","y","contextTypes","canvasOriginX","canvasOriginY","margin","ratio","canvases","bg","save","setTransform","scale","translate","left","top","restore","xPos","yPos","fill","radians","Math","PI","font","fillStyle","textAlign","beginPath","fillText"],"mappings":"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","file":"Label.js","sourcesContent":["\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport GenericComponent from \"../GenericComponent\";\n\nimport { isDefined, hexToRGBA, functor } from \"../utils\";\nimport LabelAnnotation, { defaultProps, helper } from \"./LabelAnnotation\";\n\nclass Label extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.renderSVG = this.renderSVG.bind(this);\n\t\tthis.drawOnCanvas = this.drawOnCanvas.bind(this);\n\t}\n\tdrawOnCanvas(ctx, moreProps) {\n\t\tdrawOnCanvas2(ctx, this.props, this.context, moreProps);\n\t}\n\trender() {\n\t\treturn <GenericComponent\n\t\t\tcanvasToDraw={this.props.selectCanvas}\n\t\t\tsvgDraw={this.renderSVG}\n\t\t\tcanvasDraw={this.drawOnCanvas}\n\t\t\tdrawOn={[]}\n\t\t/>;\n\t}\n\trenderSVG(moreProps) {\n\t\tconst { chartConfig } = moreProps;\n\n\t\treturn <LabelAnnotation yScale={getYScale(chartConfig)} {...this.props} text={getText(this.props)}/>;\n\t}\n}\n\nfunction getText(props) {\n\treturn functor(props.text)(props);\n}\n\nfunction getYScale(chartConfig) {\n\treturn Array.isArray(chartConfig) ? undefined : chartConfig.yScale;\n}\n\nLabel.propTypes = {\n\tclassName: PropTypes.string,\n\tselectCanvas: PropTypes.func,\n\ttext: PropTypes.oneOfType([\n\t\tPropTypes.string,\n\t\tPropTypes.func\n\t]).isRequired,\n\ttextAnchor: PropTypes.string,\n\tfontFamily: PropTypes.string,\n\tfontSize: PropTypes.number,\n\topacity: PropTypes.number,\n\trotate: PropTypes.number,\n\tonClick: PropTypes.func,\n\txAccessor: PropTypes.func,\n\txScale: PropTypes.func,\n\tyScale: PropTypes.func,\n\tdatum: PropTypes.object,\n\tx: PropTypes.oneOfType([\n\t\tPropTypes.number,\n\t\tPropTypes.func\n\t]),\n\ty: PropTypes.oneOfType([\n\t\tPropTypes.number,\n\t\tPropTypes.func\n\t])\n};\n\nLabel.contextTypes = {\n\tcanvasOriginX: PropTypes.number,\n\tcanvasOriginY: PropTypes.number,\n\n\tmargin: PropTypes.object.isRequired,\n\tratio: PropTypes.number.isRequired,\n};\n\nLabel.defaultProps = {\n\t...defaultProps,\n\tselectCanvas: canvases => canvases.bg,\n};\n\nfunction drawOnCanvas2(ctx, props, context, moreProps) {\n\tctx.save();\n\n\tconst { canvasOriginX, canvasOriginY, margin, ratio } = context;\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\tctx.scale(ratio, ratio);\n\n\n\tif (isDefined(canvasOriginX))\n\t\tctx.translate(canvasOriginX, canvasOriginY);\n\telse\n\t\tctx.translate(margin.left + (0.5 * ratio), margin.top + (0.5 * ratio));\n\n\tdrawOnCanvas(ctx, props, moreProps);\n\n\tctx.restore();\n\n}\n\nfunction drawOnCanvas(ctx, props, moreProps) {\n\tconst { textAnchor, fontFamily, fontSize, opacity, rotate } = props;\n\tconst { xScale, chartConfig, xAccessor } = moreProps;\n\n\tconst { xPos, yPos, fill, text } = helper(props, xAccessor, xScale, getYScale(chartConfig));\n\n\tconst radians = (rotate / 180) * Math.PI;\n\tctx.save();\n\tctx.translate(xPos, yPos);\n\tctx.rotate(radians);\n\n\tctx.font = `${ fontSize }px ${ fontFamily }`;\n\tctx.fillStyle = hexToRGBA(fill, opacity);\n\tctx.textAlign = textAnchor === \"middle\" ? \"center\" : textAnchor;\n\n\tctx.beginPath();\n\tctx.fillText(text, 0, 0);\n\tctx.restore();\n}\n\n\nexport default Label;\n"]}